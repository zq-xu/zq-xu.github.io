import{_ as s,o as a,c as n,Q as o}from"./chunks/framework.48927342.js";const u=JSON.parse('{"title":"Kubernetes常用配置","description":"","frontmatter":{"date":"2022-12-29T00:00:00.000Z","recommend":4},"headers":[],"relativePath":"zh/cloud-native/kubernetes/configuration.md","filePath":"zh/cloud-native/kubernetes/configuration.md"}'),e={name:"zh/cloud-native/kubernetes/configuration.md"},l=o(`<h1 id="kubernetes常用配置" tabindex="-1">Kubernetes常用配置 <a class="header-anchor" href="#kubernetes常用配置" aria-label="Permalink to &quot;Kubernetes常用配置&quot;">​</a></h1><h2 id="增加节点" tabindex="-1">增加节点 <a class="header-anchor" href="#增加节点" aria-label="Permalink to &quot;增加节点&quot;">​</a></h2><p>创建集群时控制台打印信息中含有新增节点的指令，可按照该指令增加节点至集群。</p><p>若遗失该指令，或<code>token</code>/<code>certificate-key</code>等参数过期，可参考如下方式重新生成指令：</p><ul><li><a href="#增加worker节点">增加Worker节点</a></li><li><a href="#增加master节点">增加Master节点</a></li></ul><h3 id="增加worker节点" tabindex="-1">增加Worker节点 <a class="header-anchor" href="#增加worker节点" aria-label="Permalink to &quot;增加Worker节点&quot;">​</a></h3><p>在集群中任意Master节点通过以下命令生成join命令：</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">kubeadm</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">token</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">create</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--print-join-command</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># 控制台打印信息如下：</span></span>
<span class="line"><span style="color:#B392F0;">kubeadm</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">join</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">kubernetes-vip:9443</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--token</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">grv9o6.75venx9x7sajjowp</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">\\</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">--discovery-token-ca-cert-hash</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">sha256:ea92e650eed7e5df76ab99ac545f61713d3f1ff9001a3281a1f5c71ece7309a5</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">kubeadm</span><span style="color:#24292E;"> </span><span style="color:#032F62;">token</span><span style="color:#24292E;"> </span><span style="color:#032F62;">create</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--print-join-command</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># 控制台打印信息如下：</span></span>
<span class="line"><span style="color:#6F42C1;">kubeadm</span><span style="color:#24292E;"> </span><span style="color:#032F62;">join</span><span style="color:#24292E;"> </span><span style="color:#032F62;">kubernetes-vip:9443</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--token</span><span style="color:#24292E;"> </span><span style="color:#032F62;">grv9o6.75venx9x7sajjowp</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">\\</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#005CC5;">--discovery-token-ca-cert-hash</span><span style="color:#24292E;"> </span><span style="color:#032F62;">sha256:ea92e650eed7e5df76ab99ac545f61713d3f1ff9001a3281a1f5c71ece7309a5</span></span></code></pre></div><div class="warning custom-block"><p class="custom-block-title">WARNING</p><p>如果<code>token</code>过期，join命令需要重新生成。</p></div><h3 id="增加master节点" tabindex="-1">增加Master节点 <a class="header-anchor" href="#增加master节点" aria-label="Permalink to &quot;增加Master节点&quot;">​</a></h3><ul><li><strong>步骤一</strong></li></ul><p>先按照<a href="#增加worker节点">增加Worker节点</a>的操作生成join命令。</p><ul><li><strong>步骤二</strong></li></ul><p>在集群中任意Master节点执行以下命令生成<code>certificate-key</code>:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">kubeadm</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">init</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">phase</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">upload-certs</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--upload-certs</span></span>
<span class="line"><span style="color:#6A737D;"># 控制台输出如下：</span></span>
<span class="line"><span style="color:#E1E4E8;">[upload-certs] Storing the certificates </span><span style="color:#F97583;">in</span><span style="color:#E1E4E8;"> Secret </span><span style="color:#9ECBFF;">&quot;kubeadm-certs&quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">in</span><span style="color:#E1E4E8;"> the </span><span style="color:#9ECBFF;">&quot;kube-system&quot;</span><span style="color:#E1E4E8;"> Namespace</span></span>
<span class="line"><span style="color:#E1E4E8;">[upload-certs] Using certificate key:</span></span>
<span class="line"><span style="color:#B392F0;">1e610197e25fbb02e695db6124f21874ff865044cd17b2a3fe5ca73b0d8a791c</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">kubeadm</span><span style="color:#24292E;"> </span><span style="color:#032F62;">init</span><span style="color:#24292E;"> </span><span style="color:#032F62;">phase</span><span style="color:#24292E;"> </span><span style="color:#032F62;">upload-certs</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--upload-certs</span></span>
<span class="line"><span style="color:#6A737D;"># 控制台输出如下：</span></span>
<span class="line"><span style="color:#24292E;">[upload-certs] Storing the certificates </span><span style="color:#D73A49;">in</span><span style="color:#24292E;"> Secret </span><span style="color:#032F62;">&quot;kubeadm-certs&quot;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">in</span><span style="color:#24292E;"> the </span><span style="color:#032F62;">&quot;kube-system&quot;</span><span style="color:#24292E;"> Namespace</span></span>
<span class="line"><span style="color:#24292E;">[upload-certs] Using certificate key:</span></span>
<span class="line"><span style="color:#6F42C1;">1e610197e25fbb02e695db6124f21874ff865044cd17b2a3fe5ca73b0d8a791c</span></span></code></pre></div><div class="warning custom-block"><p class="custom-block-title">WARNING</p><p><code>certificate-key</code>有效期为2h, 如果超过了2h, 需要重新生成。</p></div><ul><li><strong>步骤三</strong></li></ul><p>使用<code>--control-plane --certificate-key</code>将步骤一和步骤二中获取到的信息拼接：</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">kubeadm</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">join</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">kubernetes-vip:9443</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--token</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">grv9o6.75venx9x7sajjowp</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">\\</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">--discovery-token-ca-cert-hash</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">sha256:ea92e650eed7e5df76ab99ac545f61713d3f1ff9001a3281a1f5c71ece7309a5</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">\\</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">--control-plane</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--certificate-key</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">1</span><span style="color:#9ECBFF;">e610197e25fbb02e695db6124f21874ff865044cd17b2a3fe5ca73b0d8a791c</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">kubeadm</span><span style="color:#24292E;"> </span><span style="color:#032F62;">join</span><span style="color:#24292E;"> </span><span style="color:#032F62;">kubernetes-vip:9443</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--token</span><span style="color:#24292E;"> </span><span style="color:#032F62;">grv9o6.75venx9x7sajjowp</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">\\</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#005CC5;">--discovery-token-ca-cert-hash</span><span style="color:#24292E;"> </span><span style="color:#032F62;">sha256:ea92e650eed7e5df76ab99ac545f61713d3f1ff9001a3281a1f5c71ece7309a5</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">\\</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#005CC5;">--control-plane</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--certificate-key</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">1</span><span style="color:#032F62;">e610197e25fbb02e695db6124f21874ff865044cd17b2a3fe5ca73b0d8a791c</span></span></code></pre></div><h2 id="移除节点" tabindex="-1">移除节点 <a class="header-anchor" href="#移除节点" aria-label="Permalink to &quot;移除节点&quot;">​</a></h2><p>可使用如下指令从Kubernetes集群移除节点：</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#6A737D;"># 获取集群中的节点</span></span>
<span class="line"><span style="color:#B392F0;">kubectl</span><span style="color:#E1E4E8;">  </span><span style="color:#9ECBFF;">get</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">nodes</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># 移除指定节点</span></span>
<span class="line"><span style="color:#B392F0;">kubectl</span><span style="color:#E1E4E8;">  </span><span style="color:#9ECBFF;">delete</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">nodes</span><span style="color:#E1E4E8;"> $nodeName</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;"># 获取集群中的节点</span></span>
<span class="line"><span style="color:#6F42C1;">kubectl</span><span style="color:#24292E;">  </span><span style="color:#032F62;">get</span><span style="color:#24292E;"> </span><span style="color:#032F62;">nodes</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># 移除指定节点</span></span>
<span class="line"><span style="color:#6F42C1;">kubectl</span><span style="color:#24292E;">  </span><span style="color:#032F62;">delete</span><span style="color:#24292E;"> </span><span style="color:#032F62;">nodes</span><span style="color:#24292E;"> $nodeName</span></span></code></pre></div><h2 id="设置节点角色" tabindex="-1">设置节点角色 <a class="header-anchor" href="#设置节点角色" aria-label="Permalink to &quot;设置节点角色&quot;">​</a></h2><ul><li>将节点角色设置为<code>Master</code>：</li></ul><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">kubectl</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">label</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">nodes</span><span style="color:#E1E4E8;"> $NodeName </span><span style="color:#9ECBFF;">node-role.kubernetes.io/master=</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">kubectl</span><span style="color:#24292E;"> </span><span style="color:#032F62;">label</span><span style="color:#24292E;"> </span><span style="color:#032F62;">nodes</span><span style="color:#24292E;"> $NodeName </span><span style="color:#032F62;">node-role.kubernetes.io/master=</span></span></code></pre></div><ul><li>将节点角色设置为<code>Worker</code>：</li></ul><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">kubectl</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">label</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">nodes</span><span style="color:#E1E4E8;"> $NodeName </span><span style="color:#9ECBFF;">node-role.kubernetes.io/node=</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">kubectl</span><span style="color:#24292E;"> </span><span style="color:#032F62;">label</span><span style="color:#24292E;"> </span><span style="color:#032F62;">nodes</span><span style="color:#24292E;"> $NodeName </span><span style="color:#032F62;">node-role.kubernetes.io/node=</span></span></code></pre></div><h2 id="设置污点" tabindex="-1">设置污点 <a class="header-anchor" href="#设置污点" aria-label="Permalink to &quot;设置污点&quot;">​</a></h2><p>为<code>Master</code>节点设置污点，从而工作负载<code>Pod</code>不会被调度到该<code>Master</code>节点上：</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">kubectl</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">taint</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">nodes</span><span style="color:#E1E4E8;"> $NodeName </span><span style="color:#9ECBFF;">node-role.kubernetes.io/master=:NoSchedule</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">kubectl</span><span style="color:#24292E;"> </span><span style="color:#032F62;">taint</span><span style="color:#24292E;"> </span><span style="color:#032F62;">nodes</span><span style="color:#24292E;"> $NodeName </span><span style="color:#032F62;">node-role.kubernetes.io/master=:NoSchedule</span></span></code></pre></div><h2 id="移除污点" tabindex="-1">移除污点 <a class="header-anchor" href="#移除污点" aria-label="Permalink to &quot;移除污点&quot;">​</a></h2><p>移除<code>Master</code>节点的污点，从而工作负载<code>Pod</code>允许被调度到该<code>Master</code>节点上：</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">kubectl</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">taint</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">nodes</span><span style="color:#E1E4E8;"> $NodeName </span><span style="color:#9ECBFF;">node-role.kubernetes.io/master-</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">kubectl</span><span style="color:#24292E;"> </span><span style="color:#032F62;">taint</span><span style="color:#24292E;"> </span><span style="color:#032F62;">nodes</span><span style="color:#24292E;"> $NodeName </span><span style="color:#032F62;">node-role.kubernetes.io/master-</span></span></code></pre></div><h2 id="配置kubeconfig" tabindex="-1">配置Kubeconfig <a class="header-anchor" href="#配置kubeconfig" aria-label="Permalink to &quot;配置Kubeconfig&quot;">​</a></h2><p>从<code>Master</code>节点的<code>/etc/kubernetes/admin.conf</code>复制到目的节点上的$kubeconfigPath，然后参考以下脚本：</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">mkdir</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-p</span><span style="color:#E1E4E8;"> $HOME</span><span style="color:#9ECBFF;">/.kube</span></span>
<span class="line"><span style="color:#B392F0;">sudo</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">cp</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-i</span><span style="color:#E1E4E8;"> $kubeconfigPath $HOME</span><span style="color:#9ECBFF;">/.kube/config</span></span>
<span class="line"><span style="color:#B392F0;">sudo</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">chown</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">$(</span><span style="color:#B392F0;">id</span><span style="color:#9ECBFF;"> </span><span style="color:#79B8FF;">-u</span><span style="color:#9ECBFF;">):$(</span><span style="color:#B392F0;">id</span><span style="color:#9ECBFF;"> </span><span style="color:#79B8FF;">-g</span><span style="color:#9ECBFF;">)</span><span style="color:#E1E4E8;"> $HOME</span><span style="color:#9ECBFF;">/.kube/config</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">mkdir</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-p</span><span style="color:#24292E;"> $HOME</span><span style="color:#032F62;">/.kube</span></span>
<span class="line"><span style="color:#6F42C1;">sudo</span><span style="color:#24292E;"> </span><span style="color:#032F62;">cp</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-i</span><span style="color:#24292E;"> $kubeconfigPath $HOME</span><span style="color:#032F62;">/.kube/config</span></span>
<span class="line"><span style="color:#6F42C1;">sudo</span><span style="color:#24292E;"> </span><span style="color:#032F62;">chown</span><span style="color:#24292E;"> </span><span style="color:#032F62;">$(</span><span style="color:#6F42C1;">id</span><span style="color:#032F62;"> </span><span style="color:#005CC5;">-u</span><span style="color:#032F62;">):$(</span><span style="color:#6F42C1;">id</span><span style="color:#032F62;"> </span><span style="color:#005CC5;">-g</span><span style="color:#032F62;">)</span><span style="color:#24292E;"> $HOME</span><span style="color:#032F62;">/.kube/config</span></span></code></pre></div><h2 id="更改kubelet工作路径" tabindex="-1">更改Kubelet工作路径 <a class="header-anchor" href="#更改kubelet工作路径" aria-label="Permalink to &quot;更改Kubelet工作路径&quot;">​</a></h2><p>在Kubernetes环境中，<code>Pod</code>的卷、日志和其他一些信息将存储在节点的<code>Kubelet</code>工作路径中。</p><p>在Kubernetes节点上，默认的<code>Kubelet</code>工作路径是<code>/var/lib/kubelet</code>，如果该路径所在磁盘比较小，则不能运行很多<code>Pod</code>。如果需要将其修改为其他路径(如<code>/home/k8s/kubelet</code>)，则可参照以下步骤：</p><ul><li><strong>步骤一</strong> 编辑<code>kubeadm.conf</code>,将<code>root-dir</code>标志添加到环境中：</li></ul><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">vim</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">/usr/lib/systemd/system/kubelet.service.d/10-kubeadm.conf</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># find the Environment KUBELET_CONFIG_ARGS and add flag --root-dir=/home/k8s/kubelet</span></span>
<span class="line"><span style="color:#E1E4E8;">Environment</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">&quot;KUBELET_CONFIG_ARGS=--config=/var/lib/kubelet/config.yaml --root-dir=/home/k8s/kubelet&quot;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">vim</span><span style="color:#24292E;"> </span><span style="color:#032F62;">/usr/lib/systemd/system/kubelet.service.d/10-kubeadm.conf</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># find the Environment KUBELET_CONFIG_ARGS and add flag --root-dir=/home/k8s/kubelet</span></span>
<span class="line"><span style="color:#24292E;">Environment</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;KUBELET_CONFIG_ARGS=--config=/var/lib/kubelet/config.yaml --root-dir=/home/k8s/kubelet&quot;</span></span></code></pre></div><ul><li><strong>步骤二</strong> 重新加载守护进程</li></ul><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">systemctl</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">daemon-reload</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">systemctl</span><span style="color:#24292E;"> </span><span style="color:#032F62;">daemon-reload</span></span></code></pre></div><ul><li><strong>步骤三</strong> 重启<code>Kubelet</code></li></ul><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">systemctl</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">restart</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">kubelet</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">systemctl</span><span style="color:#24292E;"> </span><span style="color:#032F62;">restart</span><span style="color:#24292E;"> </span><span style="color:#032F62;">kubelet</span></span></code></pre></div><ul><li><strong>步骤四</strong> 查看当前<code>Kubelet</code>工作路径</li></ul><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">ps</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">aux</span><span style="color:#F97583;">|</span><span style="color:#B392F0;">grep</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">kubelet</span><span style="color:#F97583;">|</span><span style="color:#B392F0;">grep</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--</span><span style="color:#E1E4E8;">  </span><span style="color:#79B8FF;">--root-dir</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># 控制台打印如下信息，其中--root-dir对应值即为Kubelet的工作目录</span></span>
<span class="line"><span style="color:#B392F0;">root</span><span style="color:#E1E4E8;">      </span><span style="color:#79B8FF;">58574</span><span style="color:#E1E4E8;">  </span><span style="color:#79B8FF;">8.2</span><span style="color:#E1E4E8;">  </span><span style="color:#79B8FF;">0.0</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">5980920</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">118788</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">?</span><span style="color:#E1E4E8;">      </span><span style="color:#9ECBFF;">Ssl</span><span style="color:#E1E4E8;">  </span><span style="color:#79B8FF;">00</span><span style="color:#9ECBFF;">:03</span><span style="color:#E1E4E8;">   </span><span style="color:#79B8FF;">2</span><span style="color:#9ECBFF;">:29</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">/usr/bin/kubelet</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--bootstrap-kubeconfig=/etc/kubernetes/bootstrap-kubelet.conf</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--kubeconfig=/etc/kubernetes/kubelet.conf</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--config=/var/lib/kubelet/config.yaml</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--root-dir=/home/k8s/kubelet</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--network-plugin=cni</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--pod-infra-container-image=registry.cn-hangzhou.aliyuncs.com/google_containers/pause:3.6</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">ps</span><span style="color:#24292E;"> </span><span style="color:#032F62;">aux</span><span style="color:#D73A49;">|</span><span style="color:#6F42C1;">grep</span><span style="color:#24292E;"> </span><span style="color:#032F62;">kubelet</span><span style="color:#D73A49;">|</span><span style="color:#6F42C1;">grep</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--</span><span style="color:#24292E;">  </span><span style="color:#005CC5;">--root-dir</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># 控制台打印如下信息，其中--root-dir对应值即为Kubelet的工作目录</span></span>
<span class="line"><span style="color:#6F42C1;">root</span><span style="color:#24292E;">      </span><span style="color:#005CC5;">58574</span><span style="color:#24292E;">  </span><span style="color:#005CC5;">8.2</span><span style="color:#24292E;">  </span><span style="color:#005CC5;">0.0</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">5980920</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">118788</span><span style="color:#24292E;"> </span><span style="color:#032F62;">?</span><span style="color:#24292E;">      </span><span style="color:#032F62;">Ssl</span><span style="color:#24292E;">  </span><span style="color:#005CC5;">00</span><span style="color:#032F62;">:03</span><span style="color:#24292E;">   </span><span style="color:#005CC5;">2</span><span style="color:#032F62;">:29</span><span style="color:#24292E;"> </span><span style="color:#032F62;">/usr/bin/kubelet</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--bootstrap-kubeconfig=/etc/kubernetes/bootstrap-kubelet.conf</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--kubeconfig=/etc/kubernetes/kubelet.conf</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--config=/var/lib/kubelet/config.yaml</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--root-dir=/home/k8s/kubelet</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--network-plugin=cni</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--pod-infra-container-image=registry.cn-hangzhou.aliyuncs.com/google_containers/pause:3.6</span></span></code></pre></div><p>现在，当前节点的<code>Kubelet</code>工作路径已更改为<code>/home/k8s/kubelet</code>.</p>`,48),p=[l];function t(c,r,i,y,E,d){return a(),n("div",null,p)}const b=s(e,[["render",t]]);export{u as __pageData,b as default};
