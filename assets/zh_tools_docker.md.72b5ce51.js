import{_ as s,o as a,c as o,Q as n}from"./chunks/framework.48927342.js";const F=JSON.parse('{"title":"Docker","description":"","frontmatter":{"date":"2022-12-01T00:00:00.000Z"},"headers":[],"relativePath":"zh/tools/docker.md","filePath":"zh/tools/docker.md"}'),l={name:"zh/tools/docker.md"},p=n(`<h1 id="docker" tabindex="-1">Docker <a class="header-anchor" href="#docker" aria-label="Permalink to &quot;Docker&quot;">​</a></h1><ul><li><a href="https://docs.docker.com/" target="_blank" rel="noreferrer">Docker官方文档</a></li><li>Docker实践可参考<a href="https://github.com/yeasy/docker_practice" target="_blank" rel="noreferrer">Docker-从入门到实践</a></li></ul><h2 id="安装docker" tabindex="-1">安装Docker <a class="header-anchor" href="#安装docker" aria-label="Permalink to &quot;安装Docker&quot;">​</a></h2><h3 id="脚本安装" tabindex="-1">脚本安装 <a class="header-anchor" href="#脚本安装" aria-label="Permalink to &quot;脚本安装&quot;">​</a></h3><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">curl</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-fsSL</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">https://get.docker.com</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">bash</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-s</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">docker</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--mirror</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">Aliyun</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">curl</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-fsSL</span><span style="color:#24292E;"> </span><span style="color:#032F62;">https://get.docker.com</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">bash</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-s</span><span style="color:#24292E;"> </span><span style="color:#032F62;">docker</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--mirror</span><span style="color:#24292E;"> </span><span style="color:#032F62;">Aliyun</span></span></code></pre></div><h3 id="配置用户" tabindex="-1">配置用户 <a class="header-anchor" href="#配置用户" aria-label="Permalink to &quot;配置用户&quot;">​</a></h3><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">sudo</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">groupadd</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">docker</span></span>
<span class="line"><span style="color:#B392F0;">sudo</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">gpasswd</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-a</span><span style="color:#E1E4E8;"> $USER </span><span style="color:#9ECBFF;">docker</span></span>
<span class="line"><span style="color:#B392F0;">newgrp</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">docker</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">sudo</span><span style="color:#24292E;"> </span><span style="color:#032F62;">groupadd</span><span style="color:#24292E;"> </span><span style="color:#032F62;">docker</span></span>
<span class="line"><span style="color:#6F42C1;">sudo</span><span style="color:#24292E;"> </span><span style="color:#032F62;">gpasswd</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-a</span><span style="color:#24292E;"> $USER </span><span style="color:#032F62;">docker</span></span>
<span class="line"><span style="color:#6F42C1;">newgrp</span><span style="color:#24292E;"> </span><span style="color:#032F62;">docker</span></span></code></pre></div><h3 id="启动docker" tabindex="-1">启动Docker <a class="header-anchor" href="#启动docker" aria-label="Permalink to &quot;启动Docker&quot;">​</a></h3><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">systemctl</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">start</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">docker</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">systemctl</span><span style="color:#24292E;"> </span><span style="color:#032F62;">start</span><span style="color:#24292E;"> </span><span style="color:#032F62;">docker</span></span></code></pre></div><h2 id="配置docker" tabindex="-1">配置Docker <a class="header-anchor" href="#配置docker" aria-label="Permalink to &quot;配置Docker&quot;">​</a></h2><p>Docker的配置文件通常为<code>/etc/docker/daemon.json</code>(不存在的话可以创建)。</p><div class="warning custom-block"><p class="custom-block-title">WARNING</p><ul><li>JSON格式，格式错误Docker会启动不起来；</li><li>修改配置后通常需要<a href="#重启docker">重启Docker</a>方可生效;</li></ul></div><h3 id="配置镜像仓库" tabindex="-1">配置镜像仓库 <a class="header-anchor" href="#配置镜像仓库" aria-label="Permalink to &quot;配置镜像仓库&quot;">​</a></h3><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">{</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#B392F0;">&quot;insecure-registries&quot;</span><span style="color:#79B8FF;">:</span><span style="color:#E1E4E8;">[</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#B392F0;">&quot;</span><span style="color:#E1E4E8;">$hostname</span><span style="color:#B392F0;">&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">    ]</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">{</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">&quot;insecure-registries&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;">[</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6F42C1;">&quot;</span><span style="color:#24292E;">$hostname</span><span style="color:#6F42C1;">&quot;</span></span>
<span class="line"><span style="color:#24292E;">    ]</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><h2 id="重启docker" tabindex="-1">重启Docker <a class="header-anchor" href="#重启docker" aria-label="Permalink to &quot;重启Docker&quot;">​</a></h2><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">sudo</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">systemctl</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">daemon-reload</span></span>
<span class="line"><span style="color:#B392F0;">sudo</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">systemctl</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">restart</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">docker</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">sudo</span><span style="color:#24292E;"> </span><span style="color:#032F62;">systemctl</span><span style="color:#24292E;"> </span><span style="color:#032F62;">daemon-reload</span></span>
<span class="line"><span style="color:#6F42C1;">sudo</span><span style="color:#24292E;"> </span><span style="color:#032F62;">systemctl</span><span style="color:#24292E;"> </span><span style="color:#032F62;">restart</span><span style="color:#24292E;"> </span><span style="color:#032F62;">docker</span></span></code></pre></div><h2 id="docker常用指令" tabindex="-1">Docker常用指令 <a class="header-anchor" href="#docker常用指令" aria-label="Permalink to &quot;Docker常用指令&quot;">​</a></h2><h3 id="特权模式下以entrypoint命令运行镜像" tabindex="-1">特权模式下以entrypoint命令运行镜像 <a class="header-anchor" href="#特权模式下以entrypoint命令运行镜像" aria-label="Permalink to &quot;特权模式下以entrypoint命令运行镜像&quot;">​</a></h3><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">docker</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">run</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--privileged=true</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-d</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--entrypoint</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">sh</span><span style="color:#E1E4E8;"> $image </span><span style="color:#79B8FF;">-c</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;sleep 9999&quot;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">docker</span><span style="color:#24292E;"> </span><span style="color:#032F62;">run</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--privileged=true</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-d</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--entrypoint</span><span style="color:#24292E;"> </span><span style="color:#032F62;">sh</span><span style="color:#24292E;"> $image </span><span style="color:#005CC5;">-c</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;sleep 9999&quot;</span></span></code></pre></div><h3 id="指定端口和volume挂载运行镜像" tabindex="-1">指定端口和volume挂载运行镜像 <a class="header-anchor" href="#指定端口和volume挂载运行镜像" aria-label="Permalink to &quot;指定端口和volume挂载运行镜像&quot;">​</a></h3><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">docker</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">run</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--name</span><span style="color:#E1E4E8;"> $name </span><span style="color:#79B8FF;">-p</span><span style="color:#E1E4E8;"> $hostPort</span><span style="color:#9ECBFF;">:</span><span style="color:#E1E4E8;">$containerPort </span><span style="color:#79B8FF;">-v</span><span style="color:#E1E4E8;"> $hostPath</span><span style="color:#9ECBFF;">:</span><span style="color:#E1E4E8;">$containerPath </span><span style="color:#79B8FF;">-d</span><span style="color:#E1E4E8;"> $image </span><span style="color:#9ECBFF;">/bin/sh</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;sleep 999&quot;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">docker</span><span style="color:#24292E;"> </span><span style="color:#032F62;">run</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--name</span><span style="color:#24292E;"> $name </span><span style="color:#005CC5;">-p</span><span style="color:#24292E;"> $hostPort</span><span style="color:#032F62;">:</span><span style="color:#24292E;">$containerPort </span><span style="color:#005CC5;">-v</span><span style="color:#24292E;"> $hostPath</span><span style="color:#032F62;">:</span><span style="color:#24292E;">$containerPath </span><span style="color:#005CC5;">-d</span><span style="color:#24292E;"> $image </span><span style="color:#032F62;">/bin/sh</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;sleep 999&quot;</span></span></code></pre></div><h3 id="删除所有tage为none的容器" tabindex="-1">删除所有tage为none的容器 <a class="header-anchor" href="#删除所有tage为none的容器" aria-label="Permalink to &quot;删除所有tage为none的容器&quot;">​</a></h3><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">docker</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">images</span><span style="color:#F97583;">|</span><span style="color:#B392F0;">grep</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">none</span><span style="color:#F97583;">|</span><span style="color:#B392F0;">awk</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;{print $3}&#39;</span><span style="color:#F97583;">|</span><span style="color:#B392F0;">xargs</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">docker</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">rmi</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-f</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">docker</span><span style="color:#24292E;"> </span><span style="color:#032F62;">images</span><span style="color:#D73A49;">|</span><span style="color:#6F42C1;">grep</span><span style="color:#24292E;"> </span><span style="color:#032F62;">none</span><span style="color:#D73A49;">|</span><span style="color:#6F42C1;">awk</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;{print $3}&#39;</span><span style="color:#D73A49;">|</span><span style="color:#6F42C1;">xargs</span><span style="color:#24292E;"> </span><span style="color:#032F62;">docker</span><span style="color:#24292E;"> </span><span style="color:#032F62;">rmi</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-f</span></span></code></pre></div><h3 id="容器转储为tgz文件" tabindex="-1">容器转储为tgz文件 <a class="header-anchor" href="#容器转储为tgz文件" aria-label="Permalink to &quot;容器转储为tgz文件&quot;">​</a></h3><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">docker</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">save</span><span style="color:#E1E4E8;"> $image1 $image2 </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">gzip</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">&gt;</span><span style="color:#E1E4E8;"> $name</span><span style="color:#9ECBFF;">.tgz</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">docker</span><span style="color:#24292E;"> </span><span style="color:#032F62;">save</span><span style="color:#24292E;"> $image1 $image2 </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">gzip</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">&gt;</span><span style="color:#24292E;"> $name</span><span style="color:#032F62;">.tgz</span></span></code></pre></div><h3 id="登录docker仓库" tabindex="-1">登录docker仓库 <a class="header-anchor" href="#登录docker仓库" aria-label="Permalink to &quot;登录docker仓库&quot;">​</a></h3><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">docker</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">login</span><span style="color:#E1E4E8;"> $hostname </span><span style="color:#79B8FF;">-u</span><span style="color:#E1E4E8;"> $name </span><span style="color:#79B8FF;">-p</span><span style="color:#E1E4E8;"> $password</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">docker</span><span style="color:#24292E;"> </span><span style="color:#032F62;">login</span><span style="color:#24292E;"> $hostname </span><span style="color:#005CC5;">-u</span><span style="color:#24292E;"> $name </span><span style="color:#005CC5;">-p</span><span style="color:#24292E;"> $password</span></span></code></pre></div><h3 id="查看docker服务日志" tabindex="-1">查看Docker服务日志 <a class="header-anchor" href="#查看docker服务日志" aria-label="Permalink to &quot;查看Docker服务日志&quot;">​</a></h3><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">journalctl</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-u</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">docker</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--no-pager</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">journalctl</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-u</span><span style="color:#24292E;"> </span><span style="color:#032F62;">docker</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--no-pager</span></span></code></pre></div><h3 id="为当前用户赋予docker权限" tabindex="-1">为当前用户赋予Docker权限 <a class="header-anchor" href="#为当前用户赋予docker权限" aria-label="Permalink to &quot;为当前用户赋予Docker权限&quot;">​</a></h3><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">sudo</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">groupadd</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">docker</span></span>
<span class="line"><span style="color:#B392F0;">sudo</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">usermod</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-aG</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">docker</span><span style="color:#E1E4E8;"> $USER</span></span>
<span class="line"><span style="color:#B392F0;">newgrp</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">docker</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">sudo</span><span style="color:#24292E;"> </span><span style="color:#032F62;">groupadd</span><span style="color:#24292E;"> </span><span style="color:#032F62;">docker</span></span>
<span class="line"><span style="color:#6F42C1;">sudo</span><span style="color:#24292E;"> </span><span style="color:#032F62;">usermod</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-aG</span><span style="color:#24292E;"> </span><span style="color:#032F62;">docker</span><span style="color:#24292E;"> $USER</span></span>
<span class="line"><span style="color:#6F42C1;">newgrp</span><span style="color:#24292E;"> </span><span style="color:#032F62;">docker</span></span></code></pre></div>`,31),e=[p];function c(t,r,y,i,E,d){return a(),o("div",null,e)}const u=s(l,[["render",c]]);export{F as __pageData,u as default};
